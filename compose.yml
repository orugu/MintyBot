services:
  discord-bot-test:
    image: mintybot_v0.0.3
    build:
      context: .
      dockerfile: Dockerfile
    container_name: mintybot_v0.0.3
    restart: unless-stopped
    working_dir: /app
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - TMPDIR=/app/tmp
      - TEMP=/app/tmp
      - TMP=/app/tmp
      - HF_HOME=/app/hf_cache
    volumes:
      - .:/app/src
    command: [".venv/bin/python", "src/main.py"]
    #command: ["tail", "-f", "/dev/null"]

    # ✅ 최신 compose GPU 설정 방식
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
